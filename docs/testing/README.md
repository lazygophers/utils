# æµ‹è¯•æ–‡æ¡£

LazyGophers Utils é¡¹ç›®çš„å®Œæ•´æµ‹è¯•ä½“ç³»å’Œè´¨é‡ä¿è¯æ–‡æ¡£ã€‚

## ğŸ“Š é¡¹ç›®æµ‹è¯•æ¦‚è§ˆ

| æŒ‡æ ‡ | æ•´ä½“çŠ¶æ€ | ç›®æ ‡å€¼ | è¯´æ˜ |
|------|----------|--------|------|
| **æ€»ä½“è¦†ç›–ç‡** | 85%+ | 90%+ | ğŸŸ¡ è‰¯å¥½ï¼ŒæŒç»­æå‡ä¸­ |
| **æ¨¡å—æ•°é‡** | 20+ | - | âœ… å…¨è¦†ç›– |
| **æµ‹è¯•ç”¨ä¾‹** | 500+ | - | âœ… å……è¶³ |
| **CI/CD** | âœ… è‡ªåŠ¨åŒ– | âœ… å®Œå–„ | âœ… GitHub Actions |

## ğŸ§ª æ¨¡å—æµ‹è¯•çŠ¶æ€

### æµ‹è¯•è¦†ç›–ç‡æ’è¡Œ

| æ¨¡å— | è¦†ç›–ç‡ | çŠ¶æ€ | æµ‹è¯•ç”¨ä¾‹æ•° | æœ€åæ›´æ–° |
|------|--------|------|------------|----------|
| **candy** | 95%+ | ğŸŸ¢ ä¼˜ç§€ | 80+ | 2025-09-13 |
| **cryptox** | 90%+ | ğŸŸ¢ ä¼˜ç§€ | 60+ | 2025-09-12 |
| **stringx** | 92%+ | ğŸŸ¢ ä¼˜ç§€ | 45+ | 2025-09-10 |
| **json** | 90%+ | ğŸŸ¢ ä¼˜ç§€ | 30+ | 2025-09-08 |
| **network** | 85%+ | ğŸŸ¡ è‰¯å¥½ | 25+ | 2025-09-05 |
| **config** | 88%+ | ğŸŸ¡ è‰¯å¥½ | 20+ | 2025-09-03 |
| **routine** | 80%+ | ğŸŸ¡ è‰¯å¥½ | 15+ | 2025-09-01 |
| **wait** | 85%+ | ğŸŸ¡ è‰¯å¥½ | 18+ | 2025-08-30 |
| **runtime** | 88%+ | ğŸŸ¡ è‰¯å¥½ | 22+ | 2025-08-28 |
| **osx** | 90%+ | ğŸŸ¢ ä¼˜ç§€ | 35+ | 2025-08-25 |
| **hystrix** | 85%+ | ğŸŸ¡ è‰¯å¥½ | 12+ | 2025-08-20 |
| **xtime** | 72.7% | ğŸŸ¨ ä¸­ç­‰ | 50+ | 2025-09-13 |
| **randx** | 85%+ | ğŸŸ¡ è‰¯å¥½ | 25+ | 2025-08-15 |
| **å…¶ä»–æ¨¡å—** | 80%+ | ğŸŸ¡ è‰¯å¥½ | 100+ | - |

### æµ‹è¯•è´¨é‡åˆ†çº§

| ç­‰çº§ | è¦†ç›–ç‡èŒƒå›´ | çŠ¶æ€ | æ¨¡å—æ•°é‡ | æ”¹è¿›è®¡åˆ’ |
|------|------------|------|----------|----------|
| ğŸŸ¢ **ä¼˜ç§€** | 90%+ | ç”Ÿäº§å°±ç»ª | 6ä¸ª | ä¿æŒç°çŠ¶ |
| ğŸŸ¡ **è‰¯å¥½** | 80-89% | å¯ç”¨çŠ¶æ€ | 10ä¸ª | æŒç»­æ”¹è¿› |
| ğŸŸ¨ **ä¸­ç­‰** | 70-79% | éœ€è¦æ”¹è¿› | 2ä¸ª | ä¼˜å…ˆæå‡ |
| ğŸ”´ **ä¸è¶³** | <70% | éœ€è¦é‡ç‚¹å…³æ³¨ | 0ä¸ª | - |

## ğŸ“‹ æµ‹è¯•æ–‡æ¡£åˆ†ç±»

### ğŸ“Š [æ•´ä½“æµ‹è¯•æŠ¥å‘Š](project-test-report.md)
é¡¹ç›®çº§åˆ«çš„ç»¼åˆæµ‹è¯•åˆ†æ

**åŒ…å«å†…å®¹**ï¼š
- ğŸ¯ æ•´ä½“æµ‹è¯•ç­–ç•¥å’Œæ–¹æ³•è®º
- ğŸ“Š è·¨æ¨¡å—æµ‹è¯•æ•°æ®æ±‡æ€»
- ğŸ”„ æŒç»­é›†æˆå’Œè‡ªåŠ¨åŒ–æµ‹è¯•
- ğŸ“ˆ æµ‹è¯•è¶‹åŠ¿å’Œæ”¹è¿›è®¡åˆ’

### ğŸ“ [æ¨¡å—æµ‹è¯•è¯¦æƒ…](module-test-details.md)  
å„ä¸ªæ¨¡å—çš„è¯¦ç»†æµ‹è¯•æŠ¥å‘Š

**åŒ…å«å†…å®¹**ï¼š
- ğŸ§ª æ¨¡å—çº§æµ‹è¯•ç”¨ä¾‹åˆ†æ
- ğŸ“Š åŠŸèƒ½è¦†ç›–ç‡è¯¦æƒ…
- âš¡ æ€§èƒ½æµ‹è¯•ç»“æœ
- ğŸ› å·²çŸ¥é—®é¢˜å’Œä¿®å¤è®¡åˆ’

## ğŸš€ æµ‹è¯•è¿è¡ŒæŒ‡å—

### åŸºç¡€æµ‹è¯•å‘½ä»¤

```bash
# è¿è¡Œæ‰€æœ‰æ¨¡å—æµ‹è¯•
go test ./...

# è¯¦ç»†è¾“å‡º
go test -v ./...

# æµ‹è¯•è¦†ç›–ç‡
go test -cover ./...

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
go test -coverprofile=coverage.out ./...
go tool cover -html=coverage.out -o coverage.html
```

### æ¨¡å—çº§æµ‹è¯•

```bash
# æµ‹è¯•ç‰¹å®šæ¨¡å—
go test -v ./candy
go test -v ./xtime
go test -v ./cryptox

# æ¨¡å—è¦†ç›–ç‡
go test -cover ./candy
go test -cover ./xtime

# æ¨¡å—åŸºå‡†æµ‹è¯•
go test -bench=. ./candy
go test -bench=. ./xtime
```

### é«˜çº§æµ‹è¯•é€‰é¡¹

```bash
# å¹¶å‘æµ‹è¯•ï¼ˆæ£€æµ‹ç«æ€æ¡ä»¶ï¼‰
go test -race ./...

# çŸ­æµ‹è¯•ï¼ˆè·³è¿‡è€—æ—¶æµ‹è¯•ï¼‰
go test -short ./...

# å†…å­˜åˆ†æ
go test -memprofile=mem.prof ./...

# CPUåˆ†æ
go test -cpuprofile=cpu.prof ./...

# æµ‹è¯•è¶…æ—¶è®¾ç½®
go test -timeout=30s ./...
```

## ğŸ¯ æµ‹è¯•ç­–ç•¥

### æµ‹è¯•å±‚æ¬¡è®¾è®¡

#### 1. å•å…ƒæµ‹è¯• (Unit Tests)
**èŒƒå›´**: å‡½æ•°å’Œæ–¹æ³•çº§åˆ«
**è¦†ç›–ç‡ç›®æ ‡**: 90%+

```go
func TestToString(t *testing.T) {
    tests := []struct {
        name  string
        input interface{}
        want  string
    }{
        {"int", 123, "123"},
        {"float", 3.14, "3.14"},
        {"bool", true, "1"},
        {"nil", nil, ""},
    }
    
    for _, tt := range tests {
        t.Run(tt.name, func(t *testing.T) {
            got := candy.ToString(tt.input)
            assert.Equal(t, tt.want, got)
        })
    }
}
```

#### 2. é›†æˆæµ‹è¯• (Integration Tests)
**èŒƒå›´**: æ¨¡å—é—´äº¤äº’
**è¦†ç›–ç‡ç›®æ ‡**: 80%+

```go
func TestXTimeWithCandy(t *testing.T) {
    // æµ‹è¯• xtime å’Œ candy æ¨¡å—çš„åä½œ
    cal := xtime.NowCalendar()
    data := cal.ToMap()
    
    // ä½¿ç”¨ candy è¿›è¡Œæ•°æ®è½¬æ¢
    jsonStr := candy.ToString(data)
    assert.NotEmpty(t, jsonStr)
}
```

#### 3. åŸºå‡†æµ‹è¯• (Benchmark Tests)
**ç›®æ ‡**: æ€§èƒ½éªŒè¯å’Œå›å½’æ£€æµ‹

```go
func BenchmarkToString(b *testing.B) {
    for i := 0; i < b.N; i++ {
        _ = candy.ToString(12345)
    }
}
```

#### 4. å‹åŠ›æµ‹è¯• (Stress Tests)
**ç›®æ ‡**: é«˜è´Ÿè½½åœºæ™¯éªŒè¯

```go
func TestConcurrentAccess(t *testing.T) {
    const numGoroutines = 100
    const numOperations = 1000
    
    var wg sync.WaitGroup
    for i := 0; i < numGoroutines; i++ {
        wg.Add(1)
        go func() {
            defer wg.Done()
            for j := 0; j < numOperations; j++ {
                _ = candy.ToString(j)
            }
        }()
    }
    wg.Wait()
}
```

### æµ‹è¯•åˆ†ç±»æ ‡å‡†

#### âœ… å¿…éœ€æµ‹è¯• (Required)
- æ‰€æœ‰å…¬å…± API
- æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- é”™è¯¯å¤„ç†è·¯å¾„
- è¾¹ç•Œæ¡ä»¶

#### ğŸ¯ é‡ç‚¹æµ‹è¯• (Priority)
- é«˜é¢‘ä½¿ç”¨åŠŸèƒ½
- æ€§èƒ½å…³é”®è·¯å¾„
- å®‰å…¨ç›¸å…³åŠŸèƒ½
- æ•°æ®è½¬æ¢é€»è¾‘

#### ğŸ“Š è¡¥å……æµ‹è¯• (Additional)
- ç§æœ‰å‡½æ•°ï¼ˆé‡è¦çš„ï¼‰
- é…ç½®è§£æ
- å…¼å®¹æ€§æµ‹è¯•
- æ–‡æ¡£ç¤ºä¾‹éªŒè¯

## ğŸ“ˆ è´¨é‡æŒ‡æ ‡

### ä»£ç è´¨é‡é—¨ç¦

#### ğŸ”’ å¿…é¡»é€šè¿‡
- [ ] æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹é€šè¿‡
- [ ] è¦†ç›–ç‡ â‰¥ 80%
- [ ] æ— ç«æ€æ¡ä»¶
- [ ] é™æ€æ£€æŸ¥é€šè¿‡

#### ğŸ¯ å»ºè®®è¾¾åˆ°
- [ ] è¦†ç›–ç‡ â‰¥ 90%
- [ ] æ€§èƒ½æ— æ˜æ˜¾é€€åŒ–
- [ ] å†…å­˜æ³„æ¼æ£€æµ‹é€šè¿‡
- [ ] æ–‡æ¡£ç¤ºä¾‹å¯è¿è¡Œ

### æŒç»­ç›‘æ§æŒ‡æ ‡

| æŒ‡æ ‡ç±»å‹ | ç›‘æ§é¢‘ç‡ | å‘Šè­¦é˜ˆå€¼ | è´Ÿè´£äºº |
|---------|----------|----------|--------|
| **æµ‹è¯•è¦†ç›–ç‡** | æ¯æ¬¡æäº¤ | < 80% | å¼€å‘è€… |
| **æµ‹è¯•é€šè¿‡ç‡** | æ¯æ¬¡æäº¤ | < 100% | CIç³»ç»Ÿ |
| **æ€§èƒ½å›å½’** | æ¯æ—¥ | > 10% | æ€§èƒ½å›¢é˜Ÿ |
| **å†…å­˜æ³„æ¼** | æ¯å‘¨ | æ£€æµ‹åˆ° | è´¨é‡å›¢é˜Ÿ |

## ğŸ”„ CI/CD é›†æˆ

### GitHub Actions é…ç½®

```yaml
name: Tests
on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        go-version: [1.24, 1.23]
        
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Go
      uses: actions/setup-go@v3
      with:
        go-version: ${{ matrix.go-version }}
        
    - name: Run tests
      run: |
        go test -race -coverprofile=coverage.out ./...
        
    - name: Upload coverage
      uses: codecov/codecov-action@v3
      with:
        file: ./coverage.out
        
    - name: Run benchmarks
      run: go test -bench=. -benchmem ./...
```

### è´¨é‡æ£€æŸ¥æµç¨‹

```bash
#!/bin/bash
# quality-check.sh

echo "=== ä»£ç è´¨é‡æ£€æŸ¥ ==="

# 1. æ ¼å¼æ£€æŸ¥
echo "æ£€æŸ¥ä»£ç æ ¼å¼..."
go fmt ./...
goimports -w .

# 2. é™æ€åˆ†æ
echo "æ‰§è¡Œé™æ€åˆ†æ..."
go vet ./...
golangci-lint run

# 3. æµ‹è¯•æ‰§è¡Œ
echo "æ‰§è¡Œæµ‹è¯•..."
go test -race -cover ./...

# 4. åŸºå‡†æµ‹è¯•
echo "æ‰§è¡ŒåŸºå‡†æµ‹è¯•..."
go test -bench=. -benchmem ./... > benchmark_results.txt

echo "=== è´¨é‡æ£€æŸ¥å®Œæˆ ==="
```

## ğŸ“Š æµ‹è¯•æŠ¥å‘Šå’Œåˆ†æ

### å®šæœŸæŠ¥å‘Š

#### ğŸ“… æ—¥æŠ¥ (æ¯æ—¥è‡ªåŠ¨ç”Ÿæˆ)
- å½“æ—¥æµ‹è¯•æ‰§è¡Œæƒ…å†µ
- å¤±è´¥æµ‹è¯•ç»Ÿè®¡å’Œåˆ†æ
- è¦†ç›–ç‡å˜åŒ–è¶‹åŠ¿
- æ€§èƒ½åŸºå‡†å¯¹æ¯”

#### ğŸ“… å‘¨æŠ¥ (æ¯å‘¨ä¸€å‘å¸ƒ)  
- å‘¨å†…æµ‹è¯•è´¨é‡æ€»ç»“
- æ–°å¢æµ‹è¯•ç”¨ä¾‹ç»Ÿè®¡
- é—®é¢˜ä¿®å¤æƒ…å†µè·Ÿè¸ª
- ä¸‹å‘¨æ”¹è¿›è®¡åˆ’

#### ğŸ“… æœˆæŠ¥ (æ¯æœˆæ€»ç»“)
- æ•´ä½“è´¨é‡æŒ‡æ ‡è¶‹åŠ¿
- æ¨¡å—æµ‹è¯•æˆç†Ÿåº¦åˆ†æ
- æŠ€æœ¯å€ºåŠ¡è¯„ä¼°
- æµ‹è¯•ç­–ç•¥è°ƒæ•´å»ºè®®

### åˆ†æç»´åº¦

#### ğŸ“Š è¦†ç›–ç‡åˆ†æ
- è¡Œè¦†ç›–ç‡ (Line Coverage)
- å‡½æ•°è¦†ç›–ç‡ (Function Coverage)  
- åˆ†æ”¯è¦†ç›–ç‡ (Branch Coverage)
- æ¡ä»¶è¦†ç›–ç‡ (Condition Coverage)

#### âš¡ æ€§èƒ½åˆ†æ
- æ‰§è¡Œæ—¶é—´è¶‹åŠ¿
- å†…å­˜ä½¿ç”¨æ¨¡å¼
- èµ„æºæ¶ˆè€—ç»Ÿè®¡
- æ€§èƒ½å›å½’æ£€æµ‹

## ğŸ”§ æµ‹è¯•å·¥å…·å’Œæ¡†æ¶

### æ ¸å¿ƒæµ‹è¯•æ¡†æ¶

```go
// ä¸»è¦ä½¿ç”¨æ ‡å‡†åº“ + å¢å¼ºå·¥å…·
import (
    "testing"
    "github.com/stretchr/testify/assert"
    "github.com/stretchr/testify/require"
    "github.com/stretchr/testify/mock"
)
```

### æ¨èå·¥å…·é“¾

| å·¥å…· | ç”¨é€” | å®‰è£…å‘½ä»¤ |
|------|------|----------|
| **testify** | æ–­è¨€å’Œæ¨¡æ‹Ÿ | `go get github.com/stretchr/testify` |
| **ginkgo** | BDDæµ‹è¯•æ¡†æ¶ | `go get github.com/onsi/ginkgo/v2` |
| **gomega** | åŒ¹é…å™¨åº“ | `go get github.com/onsi/gomega` |
| **gotests** | æµ‹è¯•ä»£ç ç”Ÿæˆ | `go get github.com/cweill/gotests` |
| **gocov** | è¦†ç›–ç‡å·¥å…· | `go get github.com/axw/gocov` |
| **go-junit-report** | JUnitæŠ¥å‘Š | `go get github.com/jstemmer/go-junit-report` |

### æµ‹è¯•è¾…åŠ©å·¥å…·

```bash
# ç”Ÿæˆæµ‹è¯•ä»£ç 
gotests -w -all *.go

# è¦†ç›–ç‡å¯è§†åŒ–
gocov test ./... | gocov-html > coverage.html

# JUnitæ ¼å¼æŠ¥å‘Š
go test -v ./... 2>&1 | go-junit-report > report.xml
```

## ğŸ’¡ æœ€ä½³å®è·µ

### æµ‹è¯•ç¼–å†™è§„èŒƒ

#### âœ… æ¨èåšæ³•

```go
// 1. ä½¿ç”¨è¡¨é©±åŠ¨æµ‹è¯•
func TestFunction(t *testing.T) {
    tests := []struct {
        name    string
        input   InputType
        want    OutputType
        wantErr bool
    }{
        // æµ‹è¯•ç”¨ä¾‹
    }
    
    for _, tt := range tests {
        t.Run(tt.name, func(t *testing.T) {
            // æµ‹è¯•é€»è¾‘
        })
    }
}

// 2. æ¸…æ™°çš„æµ‹è¯•åç§°
func TestToString_WithValidInput_ReturnsExpectedString(t *testing.T) {
    // æµ‹è¯•é€»è¾‘
}

// 3. é€‚å½“çš„è®¾ç½®å’Œæ¸…ç†
func TestWithSetup(t *testing.T) {
    // Setup
    setUp := func() { /* åˆå§‹åŒ– */ }
    tearDown := func() { /* æ¸…ç† */ }
    
    setUp()
    defer tearDown()
    
    // æµ‹è¯•é€»è¾‘
}
```

#### âŒ é¿å…çš„åšæ³•

```go
// 1. é¿å…æµ‹è¯•åç§°ä¸æ¸…æ™°
func TestFunc1(t *testing.T) { /* ä¸å¥½çš„å‘½å */ }

// 2. é¿å…æµ‹è¯•è¿‡äºå¤æ‚
func TestEverything(t *testing.T) {
    // æµ‹è¯•å¤ªå¤šåŠŸèƒ½ï¼Œåº”è¯¥æ‹†åˆ†
}

// 3. é¿å…ç¡¬ç¼–ç ä¾èµ–
func TestWithDatabase(t *testing.T) {
    db := sql.Open("mysql", "hardcoded-connection") // ä¸å¥½çš„åšæ³•
}
```

## ğŸ”— ç›¸å…³æ–‡æ¡£

### å†…éƒ¨æ–‡æ¡£
- **[æ€§èƒ½æµ‹è¯•](../performance/)** - åŸºå‡†æµ‹è¯•å’Œæ€§èƒ½åˆ†æ
- **[å¼€å‘æŒ‡å—](../development/contributing.md)** - æµ‹è¯•è§„èŒƒå’Œè¦æ±‚
- **[æ¨¡å—æ–‡æ¡£](../modules/)** - å„æ¨¡å—çš„å…·ä½“æµ‹è¯•æƒ…å†µ

### å¤–éƒ¨èµ„æº
- [Go Testing å®˜æ–¹æ–‡æ¡£](https://golang.org/pkg/testing/)
- [Testify æ¡†æ¶æ–‡æ¡£](https://github.com/stretchr/testify)
- [æµ‹è¯•æœ€ä½³å®è·µ](https://golang.org/doc/code.html#Testing)

---

*æµ‹è¯•æ–‡æ¡£æœ€åæ›´æ–°: 2025å¹´09æœˆ13æ—¥*